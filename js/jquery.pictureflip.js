(function(e,t,n,r){var i=t.Modernizr;e.pageFlip=function(t,n){$this=this;this.element=n;this.$element=e(n);this.init(t)};e.pageFlip.defaults={time:1,shadow:true,slideTime:.2,autoRun:true,autoTime:4};e.pageFlip.prototype={init:function(t){this.options=e.extend(true,{},e.pageFlip.defaults,t);this.animated=false;if(!i.csstransforms3d){this.options.time=0;this.options.slideTime=0}this.append();this.pagination(true);if(this.options.autoRun===true){this.auto()}},append:function(){this.$element.append('<div class="prev"></div><div class="next"></div>');this.$element.find(".content").css({transition:"all "+$this.options.slideTime+"s linear"});e(".slide").height($this.$element.height()-40);e(".slide:first").addClass("current");e(".slide:first .content").addClass("slideup");if(i.csstransforms3d){this.$element.find(".slide").each(function(){e(this).append('<div class="img"></div><div class="img"></div>');var t=e(this).find("img").css("display","none").attr("src");e(this).find(".img").css({background:'url("'+t+'")',"transition-duration":$this.options.time/2+"s, "+$this.options.time/2+"s"});e(this).find(".img:last-of-type").css({right:"0",left:"auto","background-position":"100% 0"})})}},events:function(){function t(t){if(t===false)var n=$this.options.time*1e3,r=$this.options.slideTime*1e3;else var n=$this.options.time,r=$this.options.slideTime;if($this.animated===false){e(".slide:first .content").removeClass("slideup");$this.animated=true;if(t===false){var i=e(".current .img:last-of-type",$this.$element);var s=e(".current",$this.$element).nextAll(".slide:first").find(".img:first");e(".slide .img").css({"transition-duration":$this.options.time/2+"s"});s.css({opacity:"0",transform:"rotateY(90deg)","transform-origin":"100% 100%"});if($this.options.shadow===true){s.css({"box-shadow":"inset 0 0 2000px 5000px rgba(0,0,0,0.3)"});i.css({"box-shadow":"inset 0 0 2000px 5000px rgba(0,0,0,0.3)"})}setTimeout(function(){e(".current").nextAll(".slide:first").css("z-index","999");i.css({transform:"rotateY(-90deg)"})},r);setTimeout(function(){s.css({opacity:"1",transform:"rotateY(0deg)","box-shadow":"none"});e(".current").nextAll(".slide:first").css({"z-index":"999999"})},n/2+r)}setTimeout(function(){e(".current").nextAll(".slide:first").addClass("current").css({"z-index":""}).siblings().removeClass("current");e(".slide > .img:first").css({transform:"none",left:"0",right:"0","box-shadow":"none"});e(".slide > .img:last").css({transform:"none","transition-duration":"0","box-shadow":"none"});e(".slide:first",$this.$element).appendTo($this.$element);$this.animated=false;$this.pagination(false);if(t===false){e(".slide:first .content").addClass("slideup")}},n+r)}}function n(t){if(t===false)var n=$this.options.time*1e3,r=$this.options.slideTime*1e3;else var n=$this.options.time,r=$this.options.slideTime;if($this.animated===false){$this.animated=true;e(".slide:first .content").removeClass("slideup");if(t===false){var i=e(".current .img:first",$this.$element);var s=e(".current",$this.$element).nextAll(".slide:last").find(".img:last");e(".slide .img").css({"transition-duration":$this.options.time/2+"s"});setTimeout(function(){s.css({opacity:"0",transform:"rotateY(90deg)","transform-origin":"0 0","box-shadow":"inset 0 0 2000px 5000px rgba(0,0,0,0.3)"});i.css({transform:"rotateY(90deg)","transform-origin":"100% 100%","box-shadow":"inset 0 0 2000px 5000px rgba(0,0,0,0.3)"});if($this.options.shadow===true){s.css({"box-shadow":"inset 0 0 2000px 5000px rgba(0,0,0,0.3)"});i.css({"box-shadow":"inset 0 0 2000px 5000px rgba(0,0,0,0.3)"})}},r);setTimeout(function(){s.css({opacity:"1",transform:"rotateY(0)","box-shadow":"none"});e(".slide:last").css({"z-index":"999999"})},n/2+r)}setTimeout(function(){e(".slide:last").addClass("current").css({"z-index":""}).siblings().removeClass("current");e(".slide > .img:first").css({transform:"none",left:"0",right:"0","transition-duration":"0","box-shadow":"none"});e(".slide > .img:last").css({transform:"none","box-shadow":"none"});e(".slide:last",$this.$element).prependTo($this.$element);$this.animated=false;$this.pagination(false)},n+r);setTimeout(function(){if(t===false){e(".slide:first .content").addClass("slideup")}},n+r+1)}}e(".next",$this.$element).on("click",function(){t(false)});e(".prev",$this.$element).on("click",function(){n(false)});e("#pagination div",$this.$element).on("click",function(){var r=e(this).attr("class").split(" ")[0].split("-")[1],i=e("#pagination .cur").attr("class").split(" ")[0].split("-")[1],s=r-i,o=t;if(s<0){o=n}var u=0,a;var a=setInterval(function(){s=Math.abs(s);if(s!=0&&u<s){o(true)}if(u===s||s===0){clearInterval(a);e(".slide:first .content").addClass("slideup")}++u},$this.options.time*10+$this.options.slideTime*10)})},pagination:function(t){var n=0,r;if(t===true){e(this.element).append('<div id="pagination"></div>');this.$element.find(".slide").each(function(){e(this).addClass("s-"+n);e("#pagination").append('<div class="p-'+n+'"></div>');++n});r=e(".current").attr("class").split(" ")[2].split("-")[1];this.events()}else{r=e(".current").attr("class").split(" ")[1].split("-")[1]}e("#pagination div").each(function(){var t=e(this).attr("class").split("-")[1];if(t===r){e(this).addClass("cur")}else{e(this).removeClass("cur")}})},auto:function(){var n,r=false;$this.$element.on("mouseover",function(){r=true;clearInterval(n)});$this.$element.on("mouseout",function(){r=false});e(t).on("hover",function(){clearInterval(n);if(r===false){n=setInterval(function(){$this.$element.find(".next").click()},$this.options.autoTime*1e3)}})}};e.fn.pageFlip=function(t,n){return this.each(function(){new e.pageFlip(t,this)})}})(jQuery,window,document)